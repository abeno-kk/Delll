<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1.0"/>
<title>è‹±æ–‡å–®å­—éš¨æ©Ÿæ¸¬é©—ï¼ˆ70 å­—ï½œæ¯å›åˆ 15 é¡Œï¼‰</title>
<style>
  :root{--brand:#2563eb;}
  *{box-sizing:border-box}
  body{font-family:"Noto Sans TC",system-ui,Arial;background:#f6f7fb;color:#222;margin:0}
  header{padding:22px 16px;text-align:center;background:#fff;box-shadow:0 2px 10px rgba(0,0,0,.06)}
  h1{margin:0;color:var(--brand);font-size:22px}
  #app{max-width:1000px;margin:18px auto;padding:16px}
  .tabs{display:flex;gap:10px;justify-content:center;margin-bottom:12px}
  .tab{padding:10px 14px;border-radius:999px;border:1px solid #e5e7eb;background:#fff;cursor:pointer;color:#333}
  .tab.active{background:var(--brand);color:#fff;border-color:var(--brand)}
  .grid{display:grid;grid-template-columns:1fr 360px;gap:16px}
  .card{background:#fff;border-radius:14px;padding:20px;box-shadow:0 6px 18px rgba(0,0,0,.08)}
  .meta{display:flex;gap:10px;justify-content:center;margin-bottom:10px;color:#666;font-size:14px;flex-wrap:wrap}
  .pill{border:1px solid #e5e7eb;padding:6px 10px;border-radius:999px;font-size:12px;color:#555}
  .q-title{font-size:20px;margin:10px 0 14px;text-align:center}
  .opts{display:grid;grid-template-columns:1fr;gap:10px}
  .btn{border:0;border-radius:10px;padding:12px 14px;cursor:pointer;background:var(--brand);color:#fff;font-weight:700}
  .btn.block{width:100%;text-align:left}
  .btn.gray{background:#e5e7eb;color:#111}
  .btn.danger{background:#dc2626}
  .input{width:100%;font-size:18px;padding:10px 12px;border:1px solid #e5e7eb;border-radius:10px}
  .tip{margin-top:6px;color:#dc2626;font-weight:700;min-height:22px}
  .feedback{margin-top:10px;font-weight:700;min-height:24px}
  .ok{color:#16a34a}.bad{color:#dc2626}
  footer{margin-top:14px;text-align:center;color:#777;font-size:12px}
  .row{display:flex;gap:10px;margin-top:12px;justify-content:center;flex-wrap:wrap}

  /* æ­·å²è¨˜éŒ„ */
  .table{width:100%;border-collapse:collapse}
  .table th,.table td{border-bottom:1px solid #eef0f4;padding:10px 8px;text-align:center;font-size:14px}
  .table th{background:#f9fafb;font-weight:700}
  .muted{color:#666}
  .pagination{display:flex;gap:8px;justify-content:center;margin-top:10px}
  .hide{display:none !important}

  /* Modal */
  .modal{position:fixed;inset:0;background:rgba(0,0,0,.45);display:none;align-items:center;justify-content:center;padding:14px}
  .modal .panel{background:#fff;max-width:680px;width:100%;border-radius:12px;padding:16px;box-shadow:0 10px 24px rgba(0,0,0,.3)}
  .panel h3{margin:0 0 10px}
  .panel ul{margin:0;padding-left:18px;max-height:50vh;overflow:auto}
</style>
</head>
<body>
<header>
  <h1>è‹±æ–‡å–®å­—éš¨æ©Ÿæ¸¬é©—ï¼ˆ70 å­—ï½œæ¯å›åˆ 15 é¡Œï¼‰</h1>
</header>

<div id="app">
  <div class="tabs">
    <button class="tab active" id="tabQuiz">ç·´ç¿’å–®å­—</button>
    <button class="tab" id="tabHistory">æ­·å²è¨˜éŒ„</button>
  </div>

  <div class="grid" id="pageQuiz">
    <!-- å·¦ï¼šæ¸¬é©— -->
    <div class="card">
      <div class="meta">
        <span class="pill" id="status">å°šæœªé–‹å§‹</span>
        <span class="pill" id="modePill">â€”</span>
        <span class="pill">é¡Œå‹ï¼šé¸æ“‡ï¼å¡«ç©ºï¼è½éŸ³ï¼é‡çµ„</span>
      </div>

      <div id="q" class="q-title">æŒ‰ã€Œé–‹å§‹æ¸¬é©—ã€å‡ºç¬¬ä¸€é¡Œ</div>

      <div id="opts" class="opts"></div>

      <div id="fillWrap" style="display:none;">
        <input id="answer" class="input" placeholder="è¼¸å…¥è‹±æ–‡ç­”æ¡ˆâ€¦" autocomplete="off"/>
        <div id="tip" class="tip"></div>
      </div>

      <div class="row">
        <!-- åªä¿ç•™å…©å€‹æŒ‰éˆ•ï¼šä¸‹ä¸€æ­¥ã€è©¦è½ï¼ˆåƒ…è½éŸ³é¡Œå‡ºç¾ï¼‰ -->
        <button id="primary" class="btn">é–‹å§‹æ¸¬é©—</button>
        <button id="replay" class="btn gray" style="display:none;">ğŸ”Š è©¦è½</button>
      </div>

      <div id="feedback" class="feedback"></div>
      <footer>è¦å‰‡ï¼šæ¯å›åˆ 15 é¡Œï¼Œå¾ 70 é¡Œä¸­éš¨æ©ŸæŠ½é¡Œã€ä¸é‡è¤‡ï¼›é¸é …éš¨æ©Ÿæ’åºï¼›å¤šå­—è©è‡ªå‹•é¿é–‹ã€Œé‡çµ„ã€ã€‚</footer>
    </div>

    <!-- å³ï¼šæœ¬å›åˆå³æ™‚çµ±è¨ˆ -->
    <div class="card">
      <h3 style="margin-top:0">æœ¬å›åˆçµ±è¨ˆ</h3>
      <div class="muted" id="statTime">ç”¨æ™‚ï¼š00:00</div>
      <div class="muted" id="statScore">å¾—åˆ†ï¼š0 / 15</div>
      <div class="muted" id="statWrong">éŒ¯èª¤ï¼š0</div>
      <div class="row" style="margin-top:16px;justify-content:flex-start">
        <button class="btn gray" id="gotoHistory">æŸ¥çœ‹æ­·å²è¨˜éŒ„</button>
      </div>
    </div>
  </div>

  <!-- æ­·å²è¨˜éŒ„é  -->
  <div id="pageHistory" class="hide">
    <div class="card">
      <h3 style="margin:0 0 12px;">æ­·å²è¨˜éŒ„</h3>
      <table class="table" id="historyTable">
        <thead>
          <tr>
            <th>æ—¥æœŸæ™‚é–“</th>
            <th>æ®µè½</th>
            <th>å®Œæˆæ™‚é–“</th>
            <th>åˆ†æ•¸</th>
            <th>æ­£ç¢º/ç¸½é¡Œæ•¸</th>
            <th>éŒ¯èª¤é¡Œæ•¸</th>
            <th>éŒ¯èª¤è©³æƒ…</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
      <div class="pagination">
        <button class="btn gray" id="prevPage">ä¸Šä¸€é </button>
        <span class="muted" id="pageInfo">ç¬¬ 1 / 1 é </span>
        <button class="btn gray" id="nextPage">ä¸‹ä¸€é </button>
        <button class="btn danger" id="clearHistory" title="æ¸…é™¤æ‰€æœ‰æ­·å²ç´€éŒ„">æ¸…ç©ºç´€éŒ„</button>
      </div>
    </div>
  </div>
</div>

<!-- è©³æƒ… Modal -->
<div class="modal" id="modal">
  <div class="panel">
    <h3>éŒ¯èª¤è©³æƒ…</h3>
    <ul id="detailList"></ul>
    <div class="row" style="justify-content:flex-end">
      <button class="btn gray" id="closeModal">é—œé–‰</button>
    </div>
  </div>
</div>

<script>
/* ====== 70 å€‹å–®å­— ====== */
const VOCAB=[{ch:"è‹±ä¿Šçš„",en:"handsome"},{ch:"æ–°çš„",en:"new"},{ch:"åŒå­¸",en:"classmate"},{ch:"å¹´è¼•çš„",en:"young"},{ch:"å¥³äºº",en:"woman"},{ch:"éå¸¸",en:"very"},{ch:"ç¾éº—çš„",en:"beautiful"},{ch:"ä¹Ÿ",en:"also"},{ch:"å¾ˆé«˜èˆˆèªè­˜ä½ ã€‚",en:"nice to meet you",aliases:["pleased to meet you"]},{ch:"å ‚è¡¨å…„å¼Ÿå§å¦¹",en:"cousins",aliases:["cousin"]},{ch:"çœŸçš„",en:"really",aliases:["truly","indeed"]},{ch:"ä¸€æ­²",en:"one year old"},{ch:"æˆ‘çŸ¥é“äº†ã€‚",en:"I see",aliases:["got it","I got it","I understand"]},{ch:"æ­Œæ‰‹",en:"singer"},{ch:"ä¸Šç­æ—",en:"office worker",aliases:["worker","employee","salaried worker"]},{ch:"å®¶åº­ä¸»å©¦",en:"housewife",aliases:["homemaker"]},{ch:"è­¦å¯Ÿ",en:"police officer",aliases:["policeman","police"]},{ch:"ä½œå®¶",en:"writer",aliases:["author"]},{ch:"å”ä¼¯ï¼›èˆ…èˆ…",en:"uncle"},{ch:"é˜¿å§¨ï¼›å§‘å§‘",en:"aunt"},{ch:"å¦»å­",en:"wife"},{ch:"å¥³å…’",en:"daughter"},{ch:"ä¸ˆå¤«",en:"husband"},{ch:"å…’å­",en:"son"},{ch:"è¦ªæ„›çš„",en:"dear",aliases:["beloved"]},{ch:"å®¶åº­ï¼›å®¶äºº",en:"family"},{ch:"åœ‹å°",en:"elementary school",aliases:["primary school"]},{ch:"åœ‹ä¸­",en:"junior high school",aliases:["middle school"]},{ch:"å¬°å…’ï¼›å¹´å¹¼çš„",en:"baby",aliases:["infant","young"]},{ch:"çœ‹è‘—",en:"watching",aliases:["looking at","staring at"]},{ch:"å°â€¦å¾ˆçè²´",en:"precious to",aliases:["dear to","valuable to"]},{ch:"äº”å£ä¹‹å®¶",en:"a family of five",aliases:["family of five"]},{ch:"55æ­²çš„ä½œå®¶",en:"a 55-year-old writer",aliases:["55-year-old writer"]},{ch:"ä¸€æŠŠå‚˜",en:"an umbrella",aliases:["umbrella"]},{ch:"æˆ¿å­",en:"house",aliases:["home"]},{ch:"çˆ¶æ¯è¦ª",en:"parents"},{ch:"å®¢å»³",en:"living room"},{ch:"ç‰†å£",en:"wall"},{ch:"ç´«è‰²(çš„)",en:"purple"},{ch:"æœ€å–œæ„›(çš„)",en:"favorite",aliases:["favourite"]},{ch:"é¡è‰²",en:"color",aliases:["colour"]},{ch:"å»šæˆ¿",en:"kitchen"},{ch:"é£¯å»³",en:"dining room"},{ch:"ä½†æ˜¯",en:"but"},{ch:"ç°è‰²(çš„)",en:"gray",aliases:["grey"]},{ch:"æ£•è‰²(çš„)",en:"brown"},{ch:"é¤…ä¹¾",en:"cookies",aliases:["cookie","biscuits","biscuit"]},{ch:"è€é¼ ï¼ˆè¤‡æ•¸ï¼‰",en:"mice"},{ch:"å¯èƒ½",en:"maybe",aliases:["perhaps","possible"]},{ch:"æ²™ç™¼",en:"sofa",aliases:["couch"]},{ch:"é£½çš„",en:"full"},{ch:"ç­†è¨˜æœ¬",en:"notebook"},{ch:"è¨˜è™Ÿç­†ï¼›å½©è‰²ç­†",en:"marker",aliases:["felt pen","highlighter"]},{ch:"æ¯›ç­†ï¼›ç­†åˆ·",en:"brush",aliases:["paintbrush"]},{ch:"ç¦®ç‰©",en:"gift",aliases:["present"]},{ch:"é‰›ç­†ç›’",en:"pencil case"},{ch:"æµ´å®¤ï¼›å»æ‰€",en:"bathroom",aliases:["restroom","toilet","washroom"]},{ch:"æ¡Œå­",en:"table",aliases:["desk"]},{ch:"è‡¥å®¤",en:"bedroom"},{ch:"åœ¨ï¼›é™„è¿‘",en:"near",aliases:["nearby","close to"]},{ch:"åœ¨â€¦ä¹‹é–“",en:"between"},{ch:"åœ¨â€¦å¾Œé¢",en:"behind"},{ch:"åœ¨â€¦å‰é¢",en:"in front of"},{ch:"ç‰¹åˆ¥çš„",en:"special"},{ch:"åœ¨â€¦è£¡é¢",en:"in",aliases:["inside"]},{ch:"å°±",en:"then",aliases:["just"]},{ch:"å½¼æ­¤ï¼›äº’ç›¸",en:"each other",aliases:["one another"]},{ch:"åœ¨â€¦ä¸Šæ–¹ï¼›åœ¨ä¸Šæ–¹",en:"above",aliases:["over"]},{ch:"è¶³å¤ (çš„)",en:"enough"},{ch:"äºº",en:"person",aliases:["human","people"]}]; // 70

/* ====== å¸¸æ•¸èˆ‡å·¥å…· ====== */
const ROUND_SIZE=15, PAGE_SIZE=10, LS_KEY="vocabHistoryV2"; // V2 é˜²æ­¢èˆŠç‰ˆæœ¬è¡çª
const $=s=>document.querySelector(s);
const rnd=n=>Math.floor(Math.random()*n);
const shuffle=a=>a.map(v=>[Math.random(),v]).sort((x,y)=>x[0]-y[0]).map(x=>x[1]);
const norm=s=>(s||"").toLowerCase().replace(/[â€™'"]/g,"'").replace(/[-â€“â€”]/g,"-").replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g," ").trim();
const fmt=n=>n.toString().padStart(2,"0");

/* ====== æ¸¬é©—ç‹€æ…‹ ====== */
let roundIndices=[],pos=0,cur=null,mode="",utter=null;
let startTs=0, correct=0, wrong=0, wrongList=[];

/* ====== Tab åˆ‡æ› ====== */
function switchTab(which){
  if(which==="quiz"){
    $("#tabQuiz").classList.add("active"); $("#tabHistory").classList.remove("active");
    $("#pageQuiz").classList.remove("hide"); $("#pageHistory").classList.add("hide");
  }else{
    $("#tabHistory").classList.add("active"); $("#tabQuiz").classList.remove("active");
    $("#pageHistory").classList.remove("hide"); $("#pageQuiz").classList.add("hide");
    renderHistory();
  }
}
$("#tabQuiz").onclick=()=>switchTab("quiz");
$("#tabHistory").onclick=()=>switchTab("history");
$("#gotoHistory").onclick=()=>switchTab("history");

/* ====== å›åˆæ§åˆ¶ ====== */
function startRound(){
  const all=[...Array(VOCAB.length).keys()];
  roundIndices=shuffle(all).slice(0,ROUND_SIZE);
  pos=0; correct=0; wrong=0; wrongList=[]; startTs=Date.now();
  $("#feedback").textContent=""; $("#statScore").textContent=`å¾—åˆ†ï¼š0 / ${ROUND_SIZE}`; $("#statWrong").textContent=`éŒ¯èª¤ï¼š0`; $("#statTime").textContent=`ç”¨æ™‚ï¼š00:00`;
  tickTimer();
  nextQ();
}

let timerId=null;
function tickTimer(){
  clearInterval(timerId);
  timerId=setInterval(()=>{
    if(!startTs) return;
    const sec=Math.floor((Date.now()-startTs)/1000);
    $("#statTime").textContent=`ç”¨æ™‚ï¼š${fmt(Math.floor(sec/60))}:${fmt(sec%60)}`;
  },500);
}

function updateHeader(){
  $("#status").textContent=`ç¬¬ ${pos+1} / ${ROUND_SIZE} é¡Œ`;
  $("#modePill").textContent="é¡Œå‹ï¼š"+({choice:"é¸æ“‡",fill:"å¡«ç©º",audio:"è½éŸ³",jumble:"é‡çµ„"})[mode];
}

/* ====== é¡Œç›®ç”Ÿæˆ ====== */
function canJumble(word){return /^[a-zA-Z]+$/.test(word);}
function nextQ(){
  if(pos>=ROUND_SIZE){ return endRound(); }

  $("#feedback").textContent=""; $("#tip").textContent=""; $("#answer").value=""; $("#opts").innerHTML="";
  cur=VOCAB[ roundIndices[pos] ];
  const types=["choice","fill","audio","jumble"].filter(t=>t!=="jumble"||canJumble(cur.en.replace(/\s/g,"")));
  mode=types[rnd(types.length)];
  updateHeader();

  $("#fillWrap").style.display="none"; $("#replay").style.display="none";
  $("#primary").textContent=(pos===0 && $("#status").textContent==="å°šæœªé–‹å§‹")?"é–‹å§‹æ¸¬é©—":"ä¸‹ä¸€æ­¥";

  if(mode==="choice"){
    $("#q").textContent=`è«‹é¸å‡ºã€Œ${cur.ch}ã€çš„è‹±æ–‡ï¼š`;
    const opts=new Set([cur.en]);
    while(opts.size<4){ const c=VOCAB[rnd(VOCAB.length)].en; if(!opts.has(c)) opts.add(c); }
    shuffle([...opts]).forEach(o=>{
      const b=document.createElement("button");
      b.className="btn block";
      b.textContent=o;
      b.onclick=()=>submitAnswer(o);
      $("#opts").appendChild(b);
    });
  }else if(mode==="fill"){
    $("#q").textContent=`è«‹ç¿»è­¯ï¼šã€Œ${cur.ch}ã€`;
    $("#fillWrap").style.display="block"; $("#primary").textContent="ä¸‹ä¸€æ­¥";
  }else if(mode==="jumble"){
    $("#q").textContent=`è«‹æŠŠå­—æ¯é‡çµ„ç‚ºã€Œ${cur.ch}ã€çš„è‹±æ–‡ï¼š`;
    const letters=shuffle(cur.en.split("")).join(" ");
    const p=document.createElement("div"); p.style.fontSize="22px"; p.style.letterSpacing="2px"; p.style.margin="6px 0 12px"; p.textContent=letters;
    $("#opts").appendChild(p);
    $("#fillWrap").style.display="block"; $("#primary").textContent="ä¸‹ä¸€æ­¥";
  }else if(mode==="audio"){
    $("#q").textContent=`è«‹è½ç™¼éŸ³ï¼Œå¯«å‡ºå–®å­—ï¼ˆæç¤ºï¼š${cur.ch}ï¼‰`;
    $("#fillWrap").style.display="block"; $("#replay").style.display="inline-block"; speak(cur.en);
  }
}

/* ====== ç™¼éŸ³ ====== */
function speak(text){
  try{ if(utter){speechSynthesis.cancel();} utter=new SpeechSynthesisUtterance(text); utter.lang="en-US"; utter.rate=.95; speechSynthesis.speak(utter);}catch(e){}
}

/* ====== åˆ¤é¡Œæµç¨‹ ====== */
function isCorrect(ans){
  const a=norm(ans), gold=norm(cur.en);
  if(a===gold) return true;
  const al=(cur.aliases||[]).map(norm);
  return al.includes(a);
}

function submitAnswer(valueFromChoice=null){
  if(mode!=="choice"){
    const val=$("#answer").value.trim();
    if(!val){ $("#tip").textContent="è«‹è¼¸å…¥ç­”æ¡ˆï¼Œæ‰èƒ½å‰å¾€ä¸‹ä¸€æ­¥ã€‚"; $("#answer").focus(); return; }
    evaluate(val);
  }else{
    if(valueFromChoice==null){ $("#feedback").textContent="è«‹é»é¸ä¸€å€‹é¸é …ä½œç­”ã€‚"; return; }
    evaluate(valueFromChoice);
  }
}

function evaluate(ans){
  const ok=isCorrect(ans);
  if(ok){ correct++; $("#feedback").innerHTML=`<span class="ok">âœ… æ­£ç¢ºï¼</span>`; }
  else{
    wrong++; wrongList.push({ch:cur.ch, correct:cur.en, your:ans});
    $("#feedback").innerHTML=`<span class="bad">âŒ éŒ¯èª¤</span>ï¼Œæ­£ç¢ºç­”æ¡ˆï¼š<b>${cur.en}</b>`+(cur.aliases?`ï¼ˆä¹Ÿå¯ï¼š${cur.aliases.join(" / ")}ï¼‰`:"");
  }
  $("#statScore").textContent=`å¾—åˆ†ï¼š${correct} / ${ROUND_SIZE}`;
  $("#statWrong").textContent=`éŒ¯èª¤ï¼š${wrong}`;
  pos++; setTimeout(nextQ,900);
}

function endRound(){
  clearInterval(timerId);
  const elapsedSec=Math.max(1,Math.floor((Date.now()-startTs)/1000));
  const percent=Math.round((correct/ROUND_SIZE)*100); // ç™¾åˆ†åˆ¶åˆ†æ•¸

  const record={
    id:Date.now(),
    when:new Date().toLocaleString(),
    stage:"å–®å­—",
    time:`${fmt(Math.floor(elapsedSec/60))}:${fmt(elapsedSec%60)}`,
    score:percent,                  // å„²å­˜ç™¾åˆ†æ¯”
    correct,total:ROUND_SIZE,wrong,
    details:wrongList
  };
  saveHistory(record);

  $("#q").textContent="æœ¬å›åˆçµæŸ ğŸ‰";
  $("#opts").innerHTML="";
  $("#fillWrap").style.display="none";
  $("#feedback").innerHTML=`å®Œæˆæ™‚é–“ï¼š<b>${record.time}</b>ï¼Œåˆ†æ•¸ï¼š<b>${percent} åˆ†</b>ï¼ˆ${correct}/${ROUND_SIZE}ï¼‰`;
  $("#status").textContent="å›åˆå®Œæˆ";
  $("#primary").textContent="é–‹å§‹æ¸¬é©—";
  $("#replay").style.display="none";
}

/* ====== ç¶å®šä¸»æŒ‰éˆ•èˆ‡éµç›¤ ====== */
$("#primary").onclick=()=>{
  if(pos===0 && $("#status").textContent==="å°šæœªé–‹å§‹"){ startRound(); return; }
  if(pos>=ROUND_SIZE){ startRound(); return; }
  if(mode==="choice"){ $("#feedback").textContent="è«‹é»é¸ä¸€å€‹é¸é …ä½œç­”ã€‚"; }
  else{ submitAnswer(); }
};
$("#replay").onclick=()=>speak(cur?.en||"");
document.addEventListener("keydown",e=>{
  if(e.key==="Enter" && $("#fillWrap").style.display!=="none"){ submitAnswer(); }
});

/* ====== æ­·å²ï¼ˆlocalStorageï¼‰ ====== */
function getHistory(){ try{ return JSON.parse(localStorage.getItem(LS_KEY)||"[]"); }catch{ return []; } }
function saveHistory(rec){
  const list=getHistory(); list.unshift(rec);
  localStorage.setItem(LS_KEY,JSON.stringify(list));
}

let currentPage=1;
function renderHistory(page=1){
  const list=getHistory(); const totalPages=Math.max(1,Math.ceil(list.length/PAGE_SIZE));
  currentPage=Math.min(Math.max(1,page),totalPages);
  $("#pageInfo").textContent=`ç¬¬ ${currentPage} / ${totalPages} é `;

  const tbody=$("#historyTable tbody"); tbody.innerHTML="";
  const start=(currentPage-1)*PAGE_SIZE, end=start+PAGE_SIZE;
  list.slice(start,end).forEach(rec=>{
    const tr=document.createElement("tr");
    tr.innerHTML=`
      <td>${rec.when}</td>
      <td>${rec.stage}</td>
      <td>${rec.time}</td>
      <td>${rec.score} åˆ†</td>
      <td>${rec.correct} / ${rec.total}</td>
      <td>${rec.wrong}</td>
      <td><button class="btn gray" data-id="${rec.id}">æŸ¥çœ‹</button></td>`;
    tbody.appendChild(tr);
  });

  // æŸ¥çœ‹è©³æƒ…
  tbody.querySelectorAll("button[data-id]").forEach(btn=>{
    btn.onclick=()=>{
      const id=Number(btn.getAttribute("data-id"));
      const rec=getHistory().find(r=>r.id===id);
      const listEl=$("#detailList"); listEl.innerHTML="";
      if(!rec || !rec.details || rec.details.length===0){
        listEl.innerHTML="<li>æ²’æœ‰éŒ¯èª¤é¡Œç›®ã€‚</li>";
      }else{
        rec.details.forEach((d,i)=>{
          const li=document.createElement("li");
          li.innerHTML=`ç¬¬ ${i+1} é¡Œï½œ<b>${d.ch}</b>ï½œä½ çš„ç­”æ¡ˆï¼š<code>${d.your||"(ç©ºç™½)"}</code>ï½œæ­£è§£ï¼š<b>${d.correct}</b>`;
          listEl.appendChild(li);
        });
      }
      $("#modal").style.display="flex";
    };
  });
}
$("#prevPage").onclick=()=>renderHistory(currentPage-1);
$("#nextPage").onclick=()=>renderHistory(currentPage+1);
$("#clearHistory").onclick=()=>{
  if(confirm("ç¢ºå®šè¦æ¸…ç©ºæ‰€æœ‰æ­·å²è¨˜éŒ„å—ï¼Ÿ")){ localStorage.removeItem(LS_KEY); renderHistory(1); }
};
$("#closeModal").onclick=()=>$("#modal").style.display="none";
$("#modal").addEventListener("click",e=>{ if(e.target.id==="modal") $("#modal").style.display="none"; });

/* åˆå§‹ç‹€æ…‹ */
$("#status").textContent="å°šæœªé–‹å§‹";
</script>
</body>
</html>
